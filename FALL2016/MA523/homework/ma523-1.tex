\begin{problem}[Taylor's formula]
  Let \(f\colon\bbR^n\to\bbR\) be smooth, \(n\geq 2\). Prove that
  \[
    f(x)=\sum_{|\alpha|\leq k}
    \frac{1}{\alpha!}D^\alpha f(0)x^\alpha+\rmO\bigl(|x|^{k+1}\bigr)
  \]
  as \(x\to\mathbf{0}\) for each \(k=1,2,\dotsc\), assuming that you know this
  formula for \(n=1\).
  \\\\
  \emph{Hint}: Fix \(x\in\bbR^n\) and consider the function of one variable
  \(g(t)\defeq f(tx)\). Prove that
  \[
    \frac{d^m}{dt^m}g(t)
    =\sum_{|\alpha|=m}\frac{m!}{\alpha!} D^\alpha f(tx)x^\alpha,
  \]
  by induction on \(m\).
\end{problem}
\begin{solution}
  Taking the hint, fix \(x\in\bbR^n\) and consider the function of one
  variable \(g(t)\defeq f(tx)\). We claim that
  \[
    \frac{d^m}{dt^m}g(t)%
    =\sum_{|\alpha|=m}\frac{m!}{\alpha!}D^\alpha f(tx)x^\alpha.%
  \]
  \begin{subproof}[Proof of claim]
    We shall proceed by induction on \(m\). The case \(m=1\) follows easily
    from the chain rule:
    \begin{align*}
      \frac{d}{dt}g(t)
      &=\frac{d}{dt}f(tx)\\
      &=D^{(1,0,\dotsc,0)}f(tx)x_1+\dotsb+D^{(0,\dotsc,0,1)}f(tx)x_n\\
      &=\bigl(D^{(1,0,\dotsc,0)}x_1+\dotsb+D^{(0,\dotsc,0,1)}x_n\bigr)f(tx)
        \intertext{which we can write compactly as}
      &=\sum_{|\alpha|=1}\frac{1!}{\alpha!}D^\alpha f(tx)x^\alpha.
    \end{align*}

    Now, assume the result for \(n\leq m-1\). Then
    \begin{align}
      \frac{d^m}{dt^m}g(t)
      &=\frac{d}{dt}\left[\frac{d^{m-1}}{dt^{m-1}}g(t)\right]\nonumber\\
      &=\frac{d}{dt}\left[\sum_{|\alpha|=m-1}\frac{(m-1)!}{\alpha!}D^\alpha
        f(tx)x^\alpha\right]\nonumber
        \intertext{since the derivative is a linear operator, we have}
      &=\sum_{|\alpha|=m-1}\frac{(m-1)!}{\alpha!}\frac{d}{dt}
        \bigl[D^\alpha f(tx)x^\alpha\bigr]\nonumber\\
      &=\sum_{|\alpha|=m-1}\frac{(m-1)!}{\alpha!}\sum_{|\beta|=1}D^{\alpha+\beta}f(tx)x^{\alpha+\beta}\nonumber
        \intertext{but since \(f\) is smooth, the order
        in which we take derivatives does not matter and, hence the operators
        commute giving us }
      &\label{eq:1-1}
        =\left[\sum_{|\beta|=1}(Dx)^\beta
        \sum_{|\alpha|=m-1}\frac{(m-1)!}{\alpha!}(Dx)^\alpha\right] f(tx).
    \end{align}
    From here it suffices to do some combinatorics on the operators and
    reduce it to the desired expression. By the multinomial theorem, we have
    \[
      \left(\sum\nolimits_{|\alpha'|=1} (Dx)^{\alpha'}\right)^{m-1}
      =\sum_{|\alpha|=m-1}\binom{|\alpha|}{\alpha}(Dx)^\alpha
      =\sum_{|\alpha|=m-1}\frac{(m-1)!}{\alpha!}(Dx)^\alpha.
    \]
    Thus \eqref{eq:1-1} becomes
    \begin{align*}
      \left[\sum_{|\beta|=1}(Dx)^\beta
      \sum_{|\alpha|=m-1}\frac{(m-1)!}{\alpha!}(Dx)^\alpha\right] f(tx)
      &=\left[\sum_{|\beta|=1}(Dx)^\beta\left(\sum\nolimits_{|\alpha'|=1}
        (Dx)^{\alpha'}\right)^{m-1}\right]f(tx)\\
      &=\left[\left(\sum\nolimits_{|\beta|=1}
        (Dx)^{\beta}\right)^m\right]f(tx)\\
      &=\sum_{|\alpha|=m}\frac{m!}{\alpha!}(Dx)^\alpha f(tx)\\
      &=\sum_{|\alpha|=m}\frac{m!}{\alpha!}D^\alpha f(tx)x^\alpha,
    \end{align*}
    as desired.
  \end{subproof}
  Now, applying Taylor's formula in \(1\) variable to \(g(t)\) and
  evaluating at \(t=1\) we have
  \begin{align*}
    f(x)
    &=g(1)\\
    &=\sum_{i=0}^k\frac{g^{(i)}(0)}{i!}1^i+\rmO\bigl(|x|^{k+1}\bigr)\\
    &=\sum_{i=0}^k\frac{1}{i!}\sum_{|\alpha|=i}\frac{i!}{\alpha!}D^\alpha
      f(tx)x^\alpha+\rmO\bigl(|x|^{k+1}\bigr)\\
    &=\sum_{i=0}^k\sum_{|\alpha|=i}\frac{1}{\alpha!}D^\alpha f(0)x^\alpha+\rmO\bigl(|x|^{k+1}\bigr)\\
    &=\sum_{|\alpha|\leq k}\frac{1}{\alpha!}D^\alpha f(0)x^\alpha+\rmO\bigl(|x|^{k+1}\bigr)
  \end{align*}
  as desired.
\end{solution}
\newpage

\begin{problem}
  Write down the characteristic equation for the PDE
  \[
    \label{eq:1:1}
    \tag{\(*\)}
    u_t+b\cdot Du=f
  \]
  on \(\bbR^n\times(0,\infty)\), where \(b\in\bbR^n\). Using the
  characteristic equation, solve \eqref{eq:1:1} subject to the initial
  condition
  \[
    u=g
  \]
  on \(\bbR^n\times\{t=0\}\). Make sure the answer agrees with formula (5)
  in \S 2.1.2 of [E].
\end{problem}
\begin{solution}
  For reference, formula (5) in \S 2.1.2 of [E] is the solution to the
  nonhomogeneous problem
  \[
    u(x,t)=g(x -tb)+\int_0^1 f\bigl(x+(s-t)b,s\bigr)\diff s
  \]
  where \(x\in\bbR^n\), \(t>0\).

  Using the structure of characteristic ODE, we have
  \begin{align*}
    \dot p(s)
    &=-D_xF\bigl(p(s),z(s),x(s)\bigr)-D_zF\bigl(p(s),z(s),x(s)\bigr)p(s)\\
    \dot z(s)
    &=D_pF\bigl(p(s),z(s),x(s)\bigr)\cdot p(s)\\
    \dot x(s)
    &=D_pF\bigl(p(s),z(s),x(s)\bigr).
  \end{align*}
\end{solution}
\newpage

\begin{problem}
  Solve using the characteristics:
  \begin{enumerate}[label=(\alph*)]
  \item \(x_1^2u_{x_1}+x_2^2u_{x_2}=u^2\), \(u=1\) on the line
    \(x_2=2x_1\).
  \item \(uu_{x_1}+u_{x_2}=1\), \(u(x_1,x_2)=x_1/2\).
  \item \(x_1u_{x_1}+2x_2u_{x_2}+u_{x_3}=3u\),
    \(u(x_1,x_2,0)=g(x_1,x_2)\).
  \end{enumerate}
\end{problem}
\begin{solution}

\end{solution}
\newpage

\begin{problem}
  For the equation
  \[
    u=x_1u_{x_1}+x_2u_{x_2}
    +\frac{1}{2}\bigl(u_{x_1}^2+u_{x_2}^2\bigr)
  \]
  find a solution with \(u(x_1,0)=\bigl(1-x_1^2\bigr)/2\).
\end{problem}
\begin{solution}

\end{solution}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../MA523-Current-HW"
%%% End:
